http://10.1.1.63/issues/6579 Начисление пенсий НПО: пожизненные выплаты
Порядок установки:
connect cdm
D:\projects\Unifond\RFC_6469_ASSIGNMENTS\install\sql\Sequences\cdm_pay_order_filter_seq.sql
connect gazfond
\sql\Synonyms\pay_order_filter_seq.sql
\sql\Tables\create_error_tables.sql
\sql\Tables\pay_order_filters.sql
\sql\Tables\pension_agreement_addendums.sql
\sql\Triggers\pension_agrmnt_adds_bi_trg.trg
\sql\Packages\assignments_api.pks
\sql\Packages\log_pkg.pks
\sql\Packages\pay_gfnpo_pkg.pks
\sql\Views\pension_agreement_addendums_v.sql
\sql\Views\pension_agreements_v.sql
\sql\PackageBodies\assignments_api.pkb
\sql\PackageBodies\log_pkg.pkb
\sql\PackageBodies\pay_gfnpo_pkg.pkb

D:\projects\Unifond\RFC_6469_ASSIGNMENTS\install\scripts\config\create_addendums_init.sql

Проверить настройку ССПВ для 1, 5 и 6 схем (см. D:\projects\Unifond\RFC_6469_ASSIGNMENTS\install\scripts\config\config_dictionary.sql

Что сделано:
Создан пакет pay_gfnpo_pkg, и точка входа для начисления по PAY_ORDER'у: fill_charges_by_pay_order
Создана таблица pay_order_filters, для задания доп.фильтров к PAY_ORDER'у при отборе пенс.соглашений (фильтрация по вкладчику и по пенс. контракту)
Проведено тестирования начислений за июнь 2018 (т.к. импорт начислений из FND не выполнялся - расчет искусственно был ограничен только июнем):

Посчитано: 164004, полное совпадение с FND.VYPL_PEN: 163311. Не совпадают с FND.VYPL_PEN: 693 (причина - изменение размера пенсии в июне 2018, не отраженное в FND.VYPL_PEN.
Время работы программы: 2 мин. 43 сек.

Что не сделано:
Импорт начислений из FND
Полноценный тест расчета начислений

Открытые вопросы:
1. Нет импорта истории начислений НПО
2. Определение ASSIGNMENTS.PAY_CODES для пенсий, доплат, выкупных, ритуалок и т.д.


create_accounts: l_err_tag = CreateAccounts_20180724124241
Start insert transform accounts: 24.07.2018 12:42:41
insert_transform_pa_accounts: добавлено строк: 196865
Complete insert transform accounts: 24.07.2018 12:42:54
Start create accounts: 24.07.2018 12:42:54
Create 496 accounts.
Complete create accounts: 24.07.2018 12:42:55